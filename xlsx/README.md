pip install pandas openpyxl

https://pandas.pydata.org/docs/

https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html

https://www.youtube.com/watch?v=bI68wnoINwc

2. Завантаження файлу Excel в pandas

Щоб почати роботу з Excel файлом, необхідно завантажити його в об'єкт pandas DataFrame. Ось як це робиться:

```python
import pandas as pd

# Завантажуємо Excel файл у DataFrame
df = pd.read_excel('your_file.xlsx')

# Виводимо перші кілька рядків для перегляду структури даних
print(df.head())
```

Вибір конкретного аркуша (Sheet)

У файлі Excel може бути кілька аркушів. За замовчуванням pandas завантажує перший аркуш. Якщо вам потрібно вибрати інший аркуш, це можна зробити за допомогою параметра sheet_name:

```python
# Завантажуємо конкретний аркуш за його назвою
df = pd.read_excel('your_file.xlsx', sheet_name='Sheet2')

# Або за індексом аркуша (перший аркуш має індекс 0)
df = pd.read_excel('your_file.xlsx', sheet_name=1)
```

Щоб дізнатися всі доступні аркуші у файлі, можна виконати наступне:
```python
xls = pd.ExcelFile('your_file.xlsx')
print(xls.sheet_names)  # Виводить список аркушів у файлі
```

3. Основні функції роботи з DataFrame

DataFrame — це основний об'єкт у pandas для роботи з табличними даними. Ось основні методи роботи з ним:
Перегляд перших та останніх рядків

```python
# Перші 5 рядків (або більше, якщо вказати параметр)
print(df.head())

# Останні 5 рядків
print(df.tail())
```

Операції з колонками

Ви можете звертатися до колонок через їх назви:

```python
# Виведення всіх значень конкретної колонки
print(df['Column Name'])

# Виведення декількох колонок
print(df[['Column1', 'Column2']])
```
---
---
---
---
---
---
---
---
4. Обробка рівнів і вкладених структур

Іноді дані можуть мати складну вкладену структуру, де різні рівні даних розташовані на основі певних злитих або пустих комірок. Це корисно для роботи з ієрархічними даними, наприклад, продуктами, категоріями та підкатегоріями.
4.1 Визначення рівнів на основі наявності або відсутності даних у колонках

Наприклад, припустимо, у вас є файл Excel, де основні продукти зберігаються в колонці A, частини продуктів — у колонці B, а підчастини — у колонці C. Потрібно розпізнати рівні:

```python
# Ітеруємо через рядки DataFrame та будуємо ієрархію на основі колонок
for idx, row in df.iterrows():
    if pd.notnull(row['Column A']) and pd.isnull(row['Column B']):  # Основний рівень
        print(f"Main Product: {row['Column A']}")
    elif pd.notnull(row['Column B']) and pd.isnull(row['Column C']):  # Другий рівень
        print(f"  Component: {row['Column B']}")
    elif pd.notnull(row['Column C']):  # Третій рівень
        print(f"    Sub-component: {row['Column C']}")
```

4.2 Робота з об'єднаними комірками

Для більш складних структур, де використовуються об'єднані комірки (merged cells), pandas не підтримує це безпосередньо, але бібліотека openpyxl дозволяє працювати з такими комірками. Ось як отримати інформацію про об'єднані комірки:

```python
from openpyxl import load_workbook

# Завантажуємо Excel файл через openpyxl
wb = load_workbook('your_file.xlsx')

# Вибираємо потрібний аркуш
sheet = wb['Sheet1']

# Перевіряємо всі об'єднані комірки
merged_cells = sheet.merged_cells.ranges
print(merged_cells)  # Виводить всі злиті комірки
```

5. Вибір, фільтрація та маніпуляції з даними
Вибір рядків на основі умов

Щоб вибрати рядки, які задовольняють певні умови:

```
# Вибір рядків, де значення в колонці 'Price' більше 100
filtered_df = df[df['Price'] > 100]
```

Фільтрація даних

Ви можете застосовувати різні методи фільтрації для відбору даних:

```python
# Вибір рядків, де колонка 'Category' має значення 'Electronics'
filtered_df = df[df['Category'] == 'Electronics']
```

Заміна пропущених значень

Часто Excel файли містять пропущені значення. Їх можна обробляти так:

```python
# Замінюємо всі пропущені значення у колонці 'Price' на 0
df['Price'].fillna(0, inplace=True)

# Видаляємо всі рядки з пропущеними значеннями
df.dropna(inplace=True)
```

6. Групування та агрегація даних

pandas дозволяє легко групувати дані та виконувати агрегації:

```python
# Групування даних за категорією та підрахунок середньої ціни
grouped = df.groupby('Category')['Price'].mean()
print(grouped)
```

Підрахунок кількості елементів у групах

```python
# Підрахунок кількості товарів у кожній категорії
count_by_category = df['Category'].value_counts()
print(count_by_category)
```

7. Робота з кількома аркушами та запис результатів у Excel

Якщо вам потрібно працювати з кількома аркушами в Excel або записати результати назад у новий файл Excel, це також можливо.
Запис результатів у новий файл Excel

```python
# Створюємо новий Excel файл та записуємо кілька DataFrame на різні аркуші
with pd.ExcelWriter('output.xlsx') as writer:
    df.to_excel(writer, sheet_name='Sheet1')
    filtered_df.to_excel(writer, sheet_name='FilteredData')
```


8. Обробка великих файлів Excel

Для роботи з великими файлами Excel, які не поміщаються в пам'ять, pandas надає можливість читати дані частинами за допомогою параметра chunksize:

```python
# Читання файлу по частинам по 1000 рядків
chunk_size = 1000
for chunk in pd.read_excel('large_file.xlsx', sheet_name='Sheet1', chunksize=chunk_size):
    print(chunk.head())  # Обробляємо кожен шматок даних окремо
```

9. Інші корисні функції
Видалення дублікатів

Щоб видалити дублікати з DataFrame:

```python
# Видаляємо дублікати на основі всіх колонок
df.drop_duplicates(inplace=True)

# Видаляємо дублікати на основі конкретної колонки
df.drop_duplicates(subset='Column Name', inplace=True)
```

Сортування даних

Щоб відсортувати дані за конкретною колонкою:

```python
# Сортуємо дані за колонкою 'Price' по зростанню
df.sort_values(by='Price', ascending=True, inplace=True)
```

---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---
---

У бібліотеці pandas для доступу до елементів DataFrame за їх позиціями використовується атрибут .iloc[], який дозволяє здійснювати індексацію на основі цілих чисел. Це особливо корисно, коли потрібно звертатися до колонок або рядків за їх порядковими номерами, а не за назвами.

У вашому випадку, коли ви пишете filled_cells.iloc[7:15], це означає, що ви вибираєте всі елементи з 7-го по 14-й індекс (оскільки верхня межа в слайсі не включається) у серії filled_cells. Іншими словами, ви звертаєтеся до 8-ї по 15-ту колонку (якщо рахувати з 1) у DataFrame.

Щоб зрозуміти, які саме колонки відповідають цим індексам, ви можете вивести список колонок вашого DataFrame:

```python
print(df.columns)
```

Цей код виведе всі назви колонок у вашому DataFrame df з їхніми відповідними індексами. Таким чином, ви зможете зіставити індекси з назвами колонок і зрозуміти, які саме колонки ви вибираєте за допомогою iloc[7:15].

Якщо ви хочете вибрати колонки за їхніми назвами, ви можете використовувати атрибут .loc[], який дозволяє здійснювати індексацію за назвами рядків і колонок:

```python
# Вибір колонок 'H' до 'O' за назвами
selected_columns = df.loc[:, 'H':'O']
```

Так, ви можете працювати з колонками, що мають назви на кшталт AA, ZZ, AZ2, ZN5, але є важливі нюанси залежно від того, що саме ви хочете зробити.
1. Пояснення з приводу колонки та комірки:

    AA, ZZ тощо — це назви колонок.
    AZ2, ZN5 — це адреси конкретних комірок, де перша частина (наприклад, AZ) — це назва колонки, а число (наприклад, 2) — це номер рядка.

2. Як працювати з такими колонками в pandas:

Якщо ви працюєте з Excel файлами, де назви колонок можуть бути на зразок AA, ZZ тощо, pandas дозволяє легко звертатися до них через назви. Ви можете використовувати методи .loc[] або .iloc[].
2.1. Як працювати з колонками, що мають назви AA, ZZ і подібні:

Якщо у вашому Excel-файлі є колонки з назвами AA, ZZ тощо, ви можете вибирати ці колонки за допомогою .loc[]:

```python
import pandas as pd

# Припустимо, у вас є DataFrame з колонками AA, ZZ, тощо
df = pd.read_excel('your_file.xlsx')

# Вибір колонок AA і ZZ за назвами
selected_columns = df.loc[:, ['AA', 'ZZ']]

# Або вибір колонок у певному діапазоні (наприклад, від A до Z)
selected_columns = df.loc[:, 'A':'Z']

# Виводимо обрані дані
print(selected_columns)
```

2.2. Як працювати з колонками через індексацію:

Якщо ви хочете працювати з колонками за їх індексами (наприклад, звертатися до 27-ї колонки, яка може відповідати AA), ви можете використовувати .iloc[]. Але для цього потрібно знати, яке саме індексне значення відповідає конкретній назві колонки.

```python
# Вибір колонок за індексами, де 26 = AA, 25 = Z
selected_columns = df.iloc[:, 25:27]  # Колонки Z і AA
```

# 3. Як працювати з комірками на зразок AZ2, ZN5:

Комірки на зразок AZ2, ZN5 вказують на конкретне місцезнаходження в таблиці. У pandas можна звертатися до таких комірок за допомогою .loc[] або .at[] (якщо це одна комірка):

    .loc[] дозволяє звертатися до елементів за назвою ряду і колонки.
    .at[] — оптимізований метод для доступу до однієї комірки.

```python
# Звернення до конкретної комірки, наприклад AZ2
value_az2 = df.loc[1, 'AZ']  # 2-й рядок, колонка AZ (рахунок з 0)

# Якщо потрібно отримати значення конкретної комірки, наприклад ZN5:
value_zn5 = df.at[4, 'ZN']  # 5-й рядок, колонка ZN
```

4. Як працювати з діапазонами колонок типу AA:ZZ:

Якщо у вас є певний діапазон колонок з назвами на кшталт AA
, ви можете звертатися до них через .loc[]:

```python
# Вибір колонок з AA по ZZ
selected_columns = df.loc[:, 'AA':'ZZ']
print(selected_columns)
```

Так, ви можете працювати з колонками, що мають назви на кшталт AA, ZZ, AZ2, ZN5, але є важливі нюанси залежно від того, що саме ви хочете зробити.
1. Пояснення з приводу колонки та комірки:

    AA, ZZ тощо — це назви колонок.
    AZ2, ZN5 — це адреси конкретних комірок, де перша частина (наприклад, AZ) — це назва колонки, а число (наприклад, 2) — це номер рядка.

2. Як працювати з такими колонками в pandas:

Якщо ви працюєте з Excel файлами, де назви колонок можуть бути на зразок AA, ZZ тощо, pandas дозволяє легко звертатися до них через назви. Ви можете використовувати методи .loc[] або .iloc[].
2.1. Як працювати з колонками, що мають назви AA, ZZ і подібні:

Якщо у вашому Excel-файлі є колонки з назвами AA, ZZ тощо, ви можете вибирати ці колонки за допомогою .loc[]:

python

import pandas as pd

# Припустимо, у вас є DataFrame з колонками AA, ZZ, тощо
df = pd.read_excel('your_file.xlsx')

# Вибір колонок AA і ZZ за назвами
selected_columns = df.loc[:, ['AA', 'ZZ']]

# Або вибір колонок у певному діапазоні (наприклад, від A до Z)
selected_columns = df.loc[:, 'A':'Z']

# Виводимо обрані дані
print(selected_columns)

2.2. Як працювати з колонками через індексацію:

Якщо ви хочете працювати з колонками за їх індексами (наприклад, звертатися до 27-ї колонки, яка може відповідати AA), ви можете використовувати .iloc[]. Але для цього потрібно знати, яке саме індексне значення відповідає конкретній назві колонки.

python

# Вибір колонок за індексами, де 26 = AA, 25 = Z
selected_columns = df.iloc[:, 25:27]  # Колонки Z і AA

3. Як працювати з комірками на зразок AZ2, ZN5:

Комірки на зразок AZ2, ZN5 вказують на конкретне місцезнаходження в таблиці. У pandas можна звертатися до таких комірок за допомогою .loc[] або .at[] (якщо це одна комірка):

    .loc[] дозволяє звертатися до елементів за назвою ряду і колонки.
    .at[] — оптимізований метод для доступу до однієї комірки.

python

# Звернення до конкретної комірки, наприклад AZ2
value_az2 = df.loc[1, 'AZ']  # 2-й рядок, колонка AZ (рахунок з 0)

# Якщо потрібно отримати значення конкретної комірки, наприклад ZN5:
value_zn5 = df.at[4, 'ZN']  # 5-й рядок, колонка ZN

4. Як працювати з діапазонами колонок типу AA:ZZ:

Якщо у вас є певний діапазон колонок з назвами на кшталт AA
, ви можете звертатися до них через .loc[]:

python

# Вибір колонок з AA по ZZ
selected_columns = df.loc[:, 'AA':'ZZ']
print(selected_columns)

Висновок:

    Назви колонок (на кшталт AA, ZZ) можна використовувати без проблем через .loc[] або .iloc[].
    Конкретні комірки (як AZ2, ZN5) можна вибирати через .loc[] або .at[].
    Діапазони колонок (як AA
    ) можна вибирати через .loc[].

Цей підхід дозволяє працювати з таблицями Excel будь-якої складності, незалежно від назв колонок або діапазонів.